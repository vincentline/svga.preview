!function(e){"use strict";e.MeeWoo=e.MeeWoo||{},e.MeeWoo.Core=e.MeeWoo.Core||{};var t={initStage:function(t,n){if("undefined"==typeof Konva)throw new Error("Konva library not loaded");var a={width:e.innerWidth,height:e.innerHeight,backgroundColor:null},i=Object.assign({},a,n),r=new Konva.Stage({container:t,width:i.width,height:i.height}),o={stage:r,layers:this.createDefaultLayers(r),config:i,isInitialized:!0};return this.initStageEvents(o),o},createDefaultLayers:function(e){var t=new Konva.Layer({name:"backgroundLayer"}),n=new Konva.Layer({name:"editLayer"}),a=new Konva.Layer({name:"helperLayer"}),i=new Konva.Layer({name:"uiLayer"});return e.add(t,n,a,i),{backgroundLayer:t,editLayer:n,helperLayer:a,uiLayer:i}},initStageEvents:function(t){t.stage;t.eventListeners={resize:this.handleStageResize.bind(this,t)},e.addEventListener("resize",t.eventListeners.resize)},handleStageResize:function(e){var t=e.stage,n=t.container();if(n){var a=n.getBoundingClientRect();t.width(a.width),t.height(a.height)}},updateStageSize:function(e,t,n){var a=e.stage;a.width(t),a.height(n)},getLayer:function(e,t){return e.layers[t]||null},redrawLayers:function(e,t){"string"==typeof t&&(t=[t]),t.forEach(function(t){var n=e.layers[t];n&&n.draw()})},redrawAll:function(e){e.stage.draw()},destroyStage:function(t){t.eventListeners&&t.eventListeners.resize&&e.removeEventListener("resize",t.eventListeners.resize),t.stage&&t.stage.destroy(),t.isInitialized=!1,t.stage=null,t.layers=null}};e.MeeWoo.Core.KonvaStage=t}(window);