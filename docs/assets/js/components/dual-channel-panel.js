!function(n){"use strict";n.MeeWoo=n.MeeWoo||{},n.MeeWoo.Components=n.MeeWoo.Components||{},n.MeeWoo.Components.DualChannelPanel={name:"DualChannelPanel",template:'\n    <div class="side-panel side-panel--right dual-channel-panel dual-channel-panel-root" :class="{\'show\': visible}">\n      <div class="side-panel-container">\n        \x3c!-- 标题区 --\x3e\n        <div class="side-panel-header">\n          <h3 class="side-panel-title">转换为双通道MP4格式</h3>\n          <div class="side-panel-divider"></div>\n        </div>\n\n        \x3c!-- 信息区 --\x3e\n        <div class="mp4-info-section">\n          <div class="mp4-info-row">{{ sourceInfo.typeLabel }}尺寸：{{ sourceInfo.sizeWH }} 时长：{{ sourceInfo.duration }}</div>\n          <div class="mp4-compress-hint">注意：第一次转换需要加载FFmpeg（25M），请耐心等待<br>压缩质量调越低，文件就越小，画面越糊。</div>\n        </div>\n\n        \x3c!-- 配置区域 --\x3e\n        <div class="mp4-config-section" :class="{disabled: isConverting}">\n          \x3c!-- 遮罩位置 --\x3e\n          <div class="mp4-config-item">\n            <div class="mp4-config-label">遮罩位置：</div>\n            <div class="mp4-select-wrapper" :class="{open: showChannelModeDropdown, disabled: isConverting}"\n              @click="!isConverting && toggleChannelModeDropdown()">\n              <div class="mp4-select-text">\n                {{ config.channelMode === \'color-left-alpha-right\' ? \'左彩右灰\' : \'左灰右彩\' }}\n              </div>\n              <div class="mp4-select-icon">\n                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                  <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"\n                    stroke-linejoin="round" />\n                </svg>\n              </div>\n              \x3c!-- 下拉菜单 --\x3e\n              <div class="mp4-select-dropdown">\n                <div class="mp4-select-option" :class="{selected: config.channelMode === \'color-left-alpha-right\'}"\n                  @click.stop="selectChannelMode(\'color-left-alpha-right\')">\n                  左彩右灰（左侧彩色通道，右侧Alpha通道）\n                </div>\n                <div class="mp4-select-option" :class="{selected: config.channelMode === \'alpha-left-color-right\'}"\n                  @click.stop="selectChannelMode(\'alpha-left-color-right\')">\n                  左灰右彩（左侧Alpha通道，右侧彩色通道）\n                </div>\n              </div>\n            </div>\n          </div>\n\n          \x3c!-- 尺寸 --\x3e\n          <div class="mp4-config-item">\n            <div class="mp4-config-label">尺寸：</div>\n            <div class="mp4-size-container">\n              <div class="input-wrapper input-wrapper--lg mp4-size-input-wrapper">\n                <input type="number" class="base-input" v-model.number="config.width" @input="onWidthChange"\n                  :disabled="isConverting" min="0" max="3000" />\n              </div>\n              <div class="mp4-size-lock">\n                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                  <path\n                    d="M4.66667 7.33333V5.33333C4.66667 3.86057 5.86057 2.66667 7.33333 2.66667H8.66667C10.1394 2.66667 11.3333 3.86057 11.3333 5.33333V7.33333M5.33333 7.33333H10.6667C11.403 7.33333 12 7.93029 12 8.66667V12C12 12.7364 11.403 13.3333 10.6667 13.3333H5.33333C4.59695 13.3333 4 12.7364 4 12V8.66667C4 7.93029 4.59695 7.33333 5.33333 7.33333Z"\n                    stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" />\n                </svg>\n              </div>\n              <div class="input-wrapper input-wrapper--lg mp4-size-input-wrapper">\n                <input type="number" class="base-input" v-model.number="config.height" @input="onHeightChange"\n                  :disabled="isConverting" min="0" max="3000" />\n              </div>\n            </div>\n          </div>\n\n          \x3c!-- 压缩到质量 --\x3e\n          <div class="mp4-config-item">\n            <div class="mp4-config-label">压缩到质量：</div>\n            <div class="mp4-value-container">\n              <div class="input-wrapper input-wrapper--lg mp4-value-input-wrapper">\n                <input type="number" class="base-input" v-model.number="config.quality" @input="onQualityChange"\n                  :disabled="isConverting" min="1" max="100" />\n              </div>\n              <div class="input-unit">%</div>\n            </div>\n          </div>\n\n          \x3c!-- 帧率修改 --\x3e\n          <div class="mp4-config-item">\n            <div class="mp4-config-label">帧率修改：</div>\n            <div class="mp4-value-container">\n              <div class="input-wrapper input-wrapper--lg mp4-value-input-wrapper">\n                <input type="number" class="base-input" v-model.number="config.fps" @input="onFpsChange"\n                  :disabled="isConverting" min="1" max="60" />\n              </div>\n              <div class="input-unit">FPS</div>\n            </div>\n          </div>\n\n          \x3c!-- 静音 --\x3e\n          <div class="mp4-config-item">\n            <div class="mp4-config-label">静音</div>\n            <div class="mp4-mute-toggle" :class="{active: config.muted, disabled: isConverting}"\n              @click="!isConverting && (config.muted = !config.muted)">\n              <div class="mp4-mute-toggle-handle"></div>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- 底部按钮 --\x3e\n        <div class="side-panel-footer">\n          \x3c!-- 返回按钮（转换中变为取消按钮） --\x3e\n          <button v-if="!isConverting" class="material-btn-back" @click="close" title="返回">\n            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">\n              <path d="M12 16L6 10L12 4" stroke="#333333" stroke-width="2" stroke-linecap="round"\n                stroke-linejoin="round" />\n            </svg>\n            <span>取消</span>\n          </button>\n          <button v-else class="material-btn-back mp4-btn-cancel" @click="cancel" title="取消转换">\n            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">\n              <path d="M5 5L15 15M15 5L5 15" stroke="#ff4444" stroke-width="2" stroke-linecap="round"\n                stroke-linejoin="round" />\n            </svg>\n            <span>取消</span>\n          </button>\n\n          \x3c!-- 转换按钮 --\x3e\n          <button class="btn-large-secondary" :class="{\'mp4-btn-converting\': isConverting}"\n            :data-progress="progress" :disabled="disabled" @click="start">\n            <template v-if="isConverting">\n              <span class="mp4-progress-text">{{ progress }}%</span>\n              <span class="mp4-stage-text">{{ message }}</span>\n            </template>\n            <template v-else>\n              开始转换双通道MP4\n            </template>\n          </button>\n        </div>\n      </div>\n    </div>\n  ',props:{visible:{type:Boolean,default:!1},sourceInfo:{type:Object,default:function(){return{}}},initialConfig:{type:Object,default:function(){return null}},isConverting:{type:Boolean,default:!1},progress:{type:Number,default:0},message:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{config:{channelMode:"color-left-alpha-right",width:300,height:300,fps:30,quality:80,muted:!1},aspectRatio:1,showChannelModeDropdown:!1}},mounted:function(){var n=this;this._globalClickHandler=function(i){if(n.showChannelModeDropdown){var t=n.$el.querySelector(".mp4-select-wrapper");t&&!t.contains(i.target)&&(n.showChannelModeDropdown=!1)}},document.addEventListener("click",this._globalClickHandler)},beforeDestroy:function(){this._globalClickHandler&&document.removeEventListener("click",this._globalClickHandler)},watch:{visible:{immediate:!0,handler:function(n){n&&this.initParams()}}},methods:{initParams:function(){var n=this.sourceInfo;if(this.initialConfig&&this.initialConfig.width>0){if(this.config.width=this.initialConfig.width,this.initialConfig.height>0)this.config.height=this.initialConfig.height;else if(n.width&&n.height){var i=n.height/n.width;this.config.height=Math.floor(this.config.width*i)}}else n.width&&n.height?(this.config.width=n.width,this.config.height=n.height):(this.config.width=300,this.config.height=300);this.config.width>0&&this.config.height>0?this.aspectRatio=this.config.width/this.config.height:this.aspectRatio=1,this.initialConfig&&this.initialConfig.fps?this.config.fps=Math.min(60,Math.max(1,this.initialConfig.fps)):n.fps?this.config.fps=Math.min(60,Math.max(1,n.fps)):this.config.fps=30,this.initialConfig&&(this.config.quality=Math.min(100,Math.max(1,this.initialConfig.quality||80)),this.config.muted=this.initialConfig.muted||!1,this.config.channelMode=this.initialConfig.channelMode||"color-left-alpha-right")},close:function(){if(this.isConverting){if(!confirm("正在转换中，确定要取消吗？"))return;this.$emit("cancel")}this.$emit("close")},onWidthChange:function(){var n=Math.max(1,Math.min(3e3,parseInt(this.config.width)||1));if(this.config.width=n,this.aspectRatio>0){var i=Math.round(n/this.aspectRatio);i=Math.max(1,Math.min(3e3,i)),this.config.height=i}},onHeightChange:function(){var n=Math.max(1,Math.min(3e3,parseInt(this.config.height)||1));if(this.config.height=n,this.aspectRatio>0){var i=Math.round(n*this.aspectRatio);i=Math.max(1,Math.min(3e3,i)),this.config.width=i}},onQualityChange:function(){var n=parseInt(this.config.quality)||1;this.config.quality=Math.max(1,Math.min(100,n))},onFpsChange:function(){var n=parseInt(this.config.fps)||1;this.config.fps=Math.max(1,Math.min(60,n))},startConvert:function(){this.$emit("convert",this.config)},start:function(){this.startConvert()},cancel:function(){this.$emit("cancel")},toggleChannelModeDropdown:function(){this.showChannelModeDropdown=!this.showChannelModeDropdown},selectChannelMode:function(n){this.config.channelMode=n,this.showChannelModeDropdown=!1}}}}(window);