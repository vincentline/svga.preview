!function(t){"use strict";t.MeeWoo=t.MeeWoo||{},t.MeeWoo.Components=t.MeeWoo.Components||{},t.MeeWoo.Components.WebpPanel={name:"WebpPanel",template:"#tpl-webp-panel",props:{visible:{type:Boolean,default:!1},sourceInfo:{type:Object,default:function(){return{}}},initialConfig:{type:Object,default:function(){return{}}},isExporting:{type:Boolean,default:!1},exportProgress:{type:Number,default:0},exportStage:{type:String,default:""},exportMessage:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{config:{width:0,height:0,fps:24},aspectRatio:1}},computed:{estimatedInfo:function(){var t=this.sourceInfo.duration||0,i=this.config.fps||24,n=this.config.width||0,e=this.config.height||0,o=this.sourceInfo.totalFrames||Math.ceil(t*i),h=n*e*.05*o;return{totalFrames:o,totalBytes:h,fileSizeText:this.formatBytes(h)}}},watch:{visible:function(t){t&&this.initConfig()},initialConfig:{handler:function(t){this.visible&&this.initConfig()},deep:!0}},methods:{initConfig:function(){this.config={width:this.initialConfig.width||this.sourceInfo.width||0,height:this.initialConfig.height||this.sourceInfo.height||0,fps:this.initialConfig.fps||this.sourceInfo.fps||24},this.config.width>0&&this.config.height>0&&(this.aspectRatio=this.config.width/this.config.height)},onWidthChange:function(){this.config.width=Math.max(1,Math.min(3e3,parseInt(this.config.width)||0)),this.config.width>0&&(this.config.height=Math.round(this.config.width/this.aspectRatio),this.config.height=Math.max(1,Math.min(3e3,this.config.height)),this.$emit("config-change",this.config))},onHeightChange:function(){this.config.height=Math.max(1,Math.min(3e3,parseInt(this.config.height)||0)),this.config.height>0&&(this.config.width=Math.round(this.config.height*this.aspectRatio),this.config.width=Math.max(1,Math.min(3e3,this.config.width)),this.$emit("config-change",this.config))},onFpsChange:function(){this.config.fps=Math.max(1,Math.min(60,parseInt(this.config.fps)||0)),this.$emit("config-change",this.config)},startExport:function(){this.$emit("export",this.config)},close:function(){if(this.isExporting){if(!confirm("正在导出中，确定要取消吗？"))return;this.$emit("cancel")}this.$emit("close")},formatBytes:function(t){if(!t||0===t)return"0 B";var i=Math.floor(Math.log(t)/Math.log(1024));return(t/Math.pow(1024,i)).toFixed(2)+" "+["B","KB","MB","GB"][i]}},mounted:function(){this.visible&&this.initConfig()}}}(window);