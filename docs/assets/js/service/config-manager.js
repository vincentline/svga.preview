!function(e){"use strict";window.MeeWoo=window.MeeWoo||{},window.MeeWoo.Core=window.MeeWoo.Core||{};const o="svga_preview_user_config";let t=null;e.MeeWoo.Core.ConfigManager=class{constructor(){if(t)return t;this.config={},this._init(),window.addEventListener("storage",e=>{e.key===o&&(this.config=this._load())}),t=this}_init(){this.config=this._load()}_load(){try{if(!localStorage)return console.warn("[ConfigManager] localStorage 不可用"),{};const e=localStorage.getItem(o);return e?JSON.parse(e):{}}catch(e){return"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name?(console.error("[ConfigManager] 存储配额超出，配置加载失败"),this._handleQuotaExceeded()):console.warn("[ConfigManager] 配置加载失败，可能数据已损坏:",e),{}}}_persist(){try{const e=JSON.stringify(this.config),t=new Blob([e]).size;t>4718592&&console.warn("[ConfigManager] 配置数据接近存储配额限制:",t,"bytes"),localStorage.setItem(o,e)}catch(e){"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name?(console.error("[ConfigManager] 存储配额超出，配置保存失败"),this._handleQuotaExceeded()):console.error("[ConfigManager] 配置保存失败:",e)}}_handleQuotaExceeded(){try{this.config={},localStorage.removeItem(o),console.warn("[ConfigManager] 已清空配置以释放存储空间")}catch(e){console.error("[ConfigManager] 清理配置失败:",e)}}get(e,o){if(!e)return this.config;const t=e.split(".");let n=this.config;for(const e of t){if(null==n)return o;n=n[e]}return void 0!==n?n:o}set(e,o){const t=e.split("."),n=t.pop();let r=this.config;for(const e of t)"object"==typeof r[e]&&null!==r[e]||(r[e]={}),r=r[e];r[n]=o,this._persist()}getAll(){return JSON.parse(JSON.stringify(this.config))}remove(e){const o=e.split("."),t=o.pop();let n=this.config;for(const e of o){if("object"!=typeof n[e]||null===n[e])return;n=n[e]}delete n[t],this._persist()}clear(){this.config={},this._persist()}}}(window);